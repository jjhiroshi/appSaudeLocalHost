<!DOCTYPE html>
<html lang="pr-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="/global.css" >
    <title>App Saude Local Host </title>

    <script>
        var pacienteCadastrado = false;
        var sis;

        function buscarPaciente() {
            sis = document.getElementById("sis").value;

            if (sis != "") {
                $.ajax({
                    url: "buscarPaciente.php",
                    type: "GET",
                    data: {sis: sis},
                    success: function(data) {
                        // Preenche o campo NOME com o retorno da busca
                        pacienteCadastrado = true;
                        let nome = data;
                        let nomeSemEspacosIndesejados = nome.replace('   ', '');
                        document.getElementById("nome").value = nomeSemEspacosIndesejados;
                    }
                });
            }
        }

    </script>
</head>
<body>
    <header>
        <div class="bordaSuperior">
            <button type="button"
                    class="btnMenu"
                    data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasScrolling"
                    aria-controls="offcanvasScrolling"><img src="/public//img/menu-down.svg" alt="icone de menu"/>
            </button>  
        </div>
        <div class="banner">
            <div class="banner-img">
                <img src="/public/img/logo.png" alt="logo prefeitura"/>
            </div>
            <div class="banner-text">
                <h4 class='title'><strong>PREFEITURA DE MOGI DAS CRUZES</strong></h4>
                <h5 class='subtitle'><strong>SECRETARIA MUNICIPAL DE SAÚDE</strong></h5>
                <h6 class='subtitle2'><strong>UBS JARDIM IVETE</strong></h6>
            </div>
        </div>
    </header>

    <main class="formulario">
        <h5>Novo Protocolo</h5>
        <form action="gerarProtocolo.php" method="post" onsubmit="return validarCheckBox()">
            <section class="formPaciente">
                <!-- Seção de Campos do Formulário: Data, SIS e Nome -->
                 <div class="d-flex mb-3">
                    <div class="form-floating">
                        <input type="date" class="form-control" id="dataDoPedido" value="<?php echo date('Y-m-d'); ?>">
                        <label for="floatingInputValue m-1">Data do Pedido</label>
                    </div>
                    <div class="form-floating w-25">
                        <input type="text" class="form-control" id="sis" onblur="buscarPaciente()" required>
                        <label for="floatingInputValue m-1">SIS (sem traços ou pontos)</label>
                    </div>
                 </div>
                 <div class="form-floating w-50 mb-3">
                        <input type="text" class="form-control" id="nome" onblur="salvarPaciente()" required>
                        <label for="floatingInputValue m-1 letramaiuscula">NOME COMPLETO DO PACIENTE</label>
                </div>
                 
            </section>
            
            <section class="formRadiografias" >
            <!-- Seção de check-box de raio X  -->
                <h5>Exames Solicitados</h5>

                <div class="input-group mb-3 w-50">
                        <div class="input-group-text">
                            <input class="form-check-input mt-0" type="checkbox">
                        </div>
                        <input type="text" class="form-control" value="Psicologia" disabled>
                    </div>
                          
            </section>
            <input type="submit" class="btn btn-success mt-3" value="Gerar Comprovante">
        </form>
    </main>

    
    <!-- Offcanvas: Menu lateral que acessa os links para as funcionalidades do App -->
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasScrollingLabel">MENU</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <!--  Abaixo contém os links para os modais do Menu Lateral  -->
            <ul>
                <h5 class="tituloMenu">RADIOGRAFIA</h5>
                <li class="subtituloMenu">
                    <a href="/index.html" class="links"><img src="/public/img/receipt.svg" class="icones" alt="icone de protocolo"/>Gerar Novo Protocolo</a>
                </li>
                <li class="subtituloMenu">
                    <button type="button" class="btnModal" data-bs-toggle="modal" data-bs-target="#consultaRadiografia">
                        <img src="/public/img/search.svg" class="icones" alt="icone de protocolo"/>Consultar Solicitações Anteriores
                    </button>
                </li>
                <li class="subtituloMenu">
                    <button type="button" class="btnModal" data-bs-toggle="modal" data-bs-target="#relatorioRadiografia">
                        <img src="/public/img/document.svg" class="icones" alt="icone de protocolo"/>Emitir Relatório de Envio
                    </button>
                </li>
            </ul>
            <ul>
                <h5 class="tituloMenu">PSICOLOGIA</h5>
                <li class="subtituloMenu">
                    <a href="/index.html" class="links"><img src="/public/img/receipt.svg" class="icones" alt="icone de protocolo"/>Gerar Novo Protocolo</a>
                </li>
                <li class="subtituloMenu">
                    <button type="button" class="btnModal" data-bs-toggle="modal" data-bs-target="#consultaPsicologia">
                        <img src="/public/img/search.svg" class="icones" alt="icone de protocolo"/>Consultar Solicitações Anteriores
                    </button>
                </li>
                <li class="subtituloMenu">
                    <button type="button" class="btnModal" data-bs-toggle="modal" data-bs-target="#relatorioPsicologia">
                        <img src="/public/img/document.svg" class="icones" alt="icone de protocolo"/>Emitir Relatório de Envio
                    </button>
                </li>
            </ul>
            <ul>
                <h5 class="tituloMenu">PACIENTE</h5>
                <li class="subtituloMenu">
                    <button type="button" class="btnModal" data-bs-toggle="modal" data-bs-target="#alterarPaciente">
                        <img src="/public/img/pencil-square.svg" class="icones" alt="icone de protocolo"/>Alterar Dados do Cadastro
                    </button>
                </li>
                
            </ul>
        </div>
    </div>
    <!-- FIM DO OFFCANVAS - Menu lateral -->

    <!-- MODAIS -->

    <!-- Modal: Consultar Solicitações de Radiografias-->
    <article class="modal fade" id="consultaRadiografia" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Consultar Solicitações Anteriores - Radiografia</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>Realizar busca por SIS ou por parte do NOME do paciente:</h6>
                    <!-- Pesquisa por SIS -->
                    <form class="input-group mb-3">
                        <span class="input-group-text">SIS</span>
                        <div class="form-floating">
                            <input type="number" class="form-control" id="sis">
                            <label for="floatingInputGroup1">CARTÃO SIS - SEM TRAÇOS OU PONTOS - </label>
                        </div>
                        <button type="submit" class="btnForm">Pesquisar</button>
                    </form>
                    <!-- Pesquisa por NOME -->
                    <form class="input-group mb-3">
                        <span class="input-group-text">NOME</span>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="nome" oninput="this.value = this.value.toUpperCase();">
                            <label for="floatingInputGroup1">PARTE DO NOME DO PACIENTE</label>
                        </div>
                        <button type="submit" class="btnForm">Pesquisar</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </article>

    <!-- Modal: Consultar Solicitações de Psicologia-->
    <article class="modal fade" id="consultaPsicologia" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Consultar Solicitações Anteriores - Psicologia</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>Realizar busca por SIS ou por parte do NOME do paciente:</h6>
                    <!-- Pesquisa por SIS -->
                    <form class="input-group mb-3">
                        <span class="input-group-text">SIS</span>
                        <div class="form-floating">
                            <input type="number" class="form-control" id="sis">
                            <label for="floatingInputGroup1">CARTÃO SIS - SEM TRAÇOS OU PONTOS - </label>
                        </div>
                        <button type="submit" class="btnForm">Pesquisar</button>
                    </form>
                    <!-- Pesquisa por NOME -->
                    <form class="input-group mb-3">
                        <span class="input-group-text">NOME</span>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="nome" oninput="this.value = this.value.toUpperCase();">
                            <label for="floatingInputGroup1">PARTE DO NOME DO PACIENTE</label>
                        </div>
                        <button type="submit" class="btnForm">Pesquisar</button>
                    </form>
                
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </article>

    <!-- Modal: Emitir Relatórios de Solicitações de Radiografia-->
    <article class="modal fade" id="relatorioRadiografia" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Emitir Relatórios - Radiografias</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Gerar Relatório do Próximo Envio -->
                    <div class="form-conteniner">
                        <h6 class="">Enviar o próximo lote de solicitações:</h6>
                        <button type="button" id="btnEnvio">Emitir RELATÓRIO</button>
                    </div>
                    <!-- Pesquisar os relatórios já enviados -->
                    <div class="form-conteniner">
                        <h6 class="">Pesquisar os Relatórios emitidos filtrando por período:</h6>
                        
                        <form class="input-group mb-3">
                            <span class="input-group-text">INICIO</span>
                            <div class="form-floating">
                                <input type="date" class="form-control" id="dataInicio">
                                <label for="floatingInputGroup1">DATA INICIAL</label>
                            </div>
                            <span class="input-group-text">FINAL</span>
                            <div class="form-floating">
                                <input type="date" class="form-control" id="dataInicio">
                                <label for="floatingInputGroup1">DATA INICIAL</label>
                            </div>
                            <button type="submit" class="btnForm">Pesquisar</button>
                        </form>
                    </div>
                    
                
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </article>

    <!-- Modal: Emitir Relatórios de Solicitações de Psicologia-->
    <article class="modal fade" id="relatorioPsicologia" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Emitir Relatórios - Psicologia</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Gerar Relatório do Próximo Envio -->
                    <div class="form-conteniner">
                        <h6 class="">Enviar o próximo lote de solicitações:</h6>
                        <button type="button" id="btnEnvio">Emitir RELATÓRIO</button>
                    </div>
                    <!-- Pesquisar os relatórios já enviados -->
                    <div class="form-conteniner">
                        <h6 class="">Pesquisar os Relatórios emitidos filtrando por período:</h6>
                        
                        <form class="input-group mb-3">
                            <span class="input-group-text">INICIO</span>
                            <div class="form-floating">
                                <input type="date" class="form-control" id="dataInicio">
                                <label for="floatingInputGroup1">DATA INICIAL</label>
                            </div>
                            <span class="input-group-text">FINAL</span>
                            <div class="form-floating">
                                <input type="date" class="form-control" id="dataInicio">
                                <label for="floatingInputGroup1">DATA INICIAL</label>
                            </div>
                            <button type="submit" class="btnForm">Pesquisar</button>
                        </form>
                    </div>
                    
                
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </article>

    <!-- Modal: Alterar Cadastro do Paciente -->
    <article class="modal fade" id="alterarPaciente" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Alterar Cadastro de Paciente</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Pesquisa por SIS o cadastro para depois alterar -->
                    <form class="input mb-3">
                        <div class="input-group mb-3">
                            <span class="input-group-text">SIS</span>
                            <div class="form-floating">
                                <input type="number" class="form-control" id="sis">
                                <label for="floatingInputGroup1">CARTÃO SIS - SEM TRAÇOS OU PONTOS - </label>
                            </div>
                            <button type="button" class="btnForm">Pesquisar</button>
                        </div>
                        <div class="input-group mb-3">
                            <span class="input-group-text">NOME</span>
                            <div class="form-floating">
                                <input type="text" class="form-control" id="nome" oninput="this.value = this.value.toUpperCase();">
                                <label for="floatingInputGroup1">NOME DO PACIENTE</label>
                            </div>
                            <button type="submit" class="btnForm">Salvar Alterações</button>
                        </div>
                    </form>                   
                
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </article>

    <!-- FIM DOS MODAIS -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>